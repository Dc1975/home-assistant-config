- id: '1675604172029'
  alias: BZ Rolladen ab
  description: ""
  trigger:
    - platform: time
      at: input_datetime.idt_bz_cover_down_workday
      id: window_workday
    - platform: time
      at: input_datetime.idt_bz_cover_down_weekend
      id: window_weekend
  condition:
    - condition: template
      value_template: "{{states('input_boolean.ib_bz_cover_used_in_automations') == 'on' }}"  
    - condition: or
      conditions:
        - condition: and
          conditions:
            - condition: trigger
              id: window_workday
            - condition: state
              entity_id: binary_sensor.workday_sensor
              state: "on"
        - condition: and
          conditions:
            - condition: trigger
              id: window_weekend
            - condition: state
              entity_id: binary_sensor.workday_sensor
              state: "off"
  action:
    - service: input_boolean.turn_on
      data: {}
      target:
        entity_id: input_boolean.ib_bz_cover_up_down_automation_runs
    - service: script.turn_on
      data: 
        variables:
          cover_position: "{{states('input_number.in_ha_covers_close_position') | int}}"
      target:
        entity_id: script.bz_covers_down
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.ib_bz_cover_position_changed                
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.ib_bz_covers_closed_by_summer_mode     
    - delay: "00:00:{{ states('input_number.in_ha_covers_span_time_delay') | int }}"                
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.ib_bz_cover_up_down_automation_runs    
  mode: single